<script setup>
/** Vendor */
import { ref, watch, onMounted } from "vue"
import { DateTime } from "luxon"

/** Config */
import { useServerURL, useSocketURL } from "@/services/config"

/** Local Components */
import Globe from "../local/Globe.vue"
import Feed from "../local/Feed.vue"
import TPM from "../local/TPM.vue"

/** API */
import { fetchThxByHeight } from "@/services/api/tx"

/** UI */
import { Dropdown, DropdownItem } from "@/components/ui/Dropdown"
import Tooltip from "@/components/ui/Tooltip.vue"

/** Store */
import { useAppStore } from "@/stores/app"
const appStore = useAppStore()

const globeWidgetEl = ref(null)

const txs = ref([])

const socket = ref()

const startWs = () => {
	socket.value = new WebSocket(useSocketURL())

	socket.value.addEventListener("open", (e) => {
		socket.value.send(
			JSON.stringify({
				method: "subscribe",
				body: {
					channel: "blocks",
				},
			}),
		)
	})

	socket.value.addEventListener("message", async (e) => {
		const data = JSON.parse(e.data)
		if (data.channel === "blocks") {
			txs.value = await fetchThxByHeight({ height: data.body.height, from: parseInt(DateTime.fromISO(data.body.time) / 1000) })
		}
	})

	socket.value.addEventListener("close", () => {
		socket.value = null
		setTimeout(startWs, 1_000)
	})
}

onMounted(() => {
	startWs()
})

watch(
	() => appStore.head,
	async () => {
		if (txs.value.length) return

		txs.value = await fetchThxByHeight({
			height: appStore.head.last_height,
			from: parseInt(DateTime.fromISO(appStore.head.last_time) / 1000),
		})
	},
)

watch(
	() => appStore.network,
	() => {
		socket.value.close()

		txs.value = []
	},
)
</script>

<template>
	<Flex ref="globeWidgetEl" justify="between" :class="$style.wrapper">
		<Globe v-if="globeWidgetEl" :parent="globeWidgetEl?.wrapper" :txs="txs" />
		<div :class="$style.atm_wrapper">
			<div :class="$style.atm" />
		</div>

		<Flex direction="column" gap="24" :class="$style.controls">
			<Flex direction="column" gap="20">
				<Flex direction="column" gap="12">
					<svg width="348" height="22" viewBox="0 0 348 22" fill="none" xmlns="http://www.w3.org/2000/svg">
						<g clip-path="url(#clip0_6_23)">
							<path
								fill-rule="evenodd"
								clip-rule="evenodd"
								d="M17.7263 13.0702C16.5827 17.3369 12.1967 19.87 7.93063 18.7259C3.66284 17.5834 1.13022 13.1969 2.27492 8.93023C2.7199 7.2576 3.69771 5.77548 5.06034 4.70827C6.03685 3.9406 7.17896 3.41129 8.3959 3.1624C9.61284 2.91352 10.8711 2.95192 12.0706 3.27456C13.2705 3.59505 14.3791 4.19098 15.3084 5.015C16.2377 5.83902 16.9619 6.86842 17.4237 8.02139C18.0705 9.62673 18.1768 11.3991 17.7263 13.0702ZM8.16249 6.61707C8.27499 6.50457 8.33819 6.35199 8.33819 6.19289C8.33819 6.0338 8.27499 5.88121 8.16249 5.76872C8.04999 5.65622 7.89741 5.59302 7.73831 5.59301C7.57921 5.59302 7.42663 5.65622 7.31414 5.76871C7.20164 5.88121 7.13844 6.03379 7.13844 6.19289C7.13844 6.35199 7.20164 6.50457 7.31414 6.61707C7.42664 6.72957 7.57922 6.79277 7.73831 6.79277C7.89741 6.79277 8.04999 6.72957 8.16249 6.61707ZM10.7076 9.16213C10.8951 8.97463 11.0004 8.72033 11.0004 8.45517C11.0004 8.19001 10.895 7.93571 10.7076 7.74821C10.5201 7.56071 10.2658 7.45538 10.0006 7.45538C9.73543 7.45538 9.48113 7.56071 9.29363 7.74821C9.10613 7.93571 9.0008 8.19001 9.0008 8.45517C9.0008 8.72033 9.10613 8.97463 9.29363 9.16213C9.48113 9.34963 9.73543 9.45496 10.0006 9.45496C10.2658 9.45496 10.5201 9.34963 10.7076 9.16213ZM13.2526 11.7072C13.4401 11.5197 13.5454 11.2654 13.5454 11.0002C13.5454 10.7351 13.4401 10.4808 13.2526 10.2933C13.0651 10.1058 12.8108 10.0004 12.5457 10.0004C12.2805 10.0004 12.0262 10.1058 11.8387 10.2933C11.6512 10.4808 11.5459 10.7351 11.5459 11.0002C11.5459 11.2654 11.6512 11.5197 11.8387 11.7072C12.0262 11.8947 12.2805 12 12.5457 12C12.8108 12 13.0651 11.8947 13.2526 11.7072ZM10.7076 12.8383C10.8951 13.0258 11.0004 13.2801 11.0004 13.5453C11.0004 13.8105 10.8951 14.0648 10.7076 14.2522C10.5201 14.4397 10.2658 14.5451 10.0006 14.5451C9.73544 14.5451 9.48114 14.4397 9.29364 14.2522C9.10614 14.0647 9.00081 13.8104 9.00081 13.5453C9.00081 13.2801 9.10614 13.0258 9.29364 12.8383C9.48114 12.6508 9.73544 12.5455 10.0006 12.5455C10.2658 12.5455 10.5201 12.6508 10.7076 12.8383ZM8.1625 11.7072C8.35 11.5197 8.45533 11.2654 8.45533 11.0002C8.45533 10.7351 8.34999 10.4808 8.1625 10.2933C7.975 10.1058 7.7207 10.0004 7.45553 10.0004C7.19037 10.0004 6.93607 10.1058 6.74857 10.2933C6.56108 10.4808 6.45574 10.7351 6.45574 11.0002C6.45574 11.2654 6.56108 11.5197 6.74858 11.7072C6.93607 11.8947 7.19038 12 7.45554 12C7.7207 12 7.975 11.8947 8.1625 11.7072ZM15.2321 12.8383C15.3446 12.9508 15.4078 13.1034 15.4078 13.2625C15.4078 13.4216 15.3446 13.5742 15.2321 13.6867C15.1196 13.7992 14.967 13.8624 14.8079 13.8624C14.6488 13.8624 14.4963 13.7992 14.3838 13.6867C14.2713 13.5742 14.2081 13.4216 14.2081 13.2625C14.2081 13.1034 14.2713 12.9508 14.3838 12.8383C14.4963 12.7258 14.6488 12.6626 14.8079 12.6626C14.967 12.6626 15.1196 12.7258 15.2321 12.8383ZM12.6871 16.2317C12.7996 16.1192 12.8628 15.9667 12.8628 15.8076C12.8628 15.6485 12.7996 15.4959 12.6871 15.3834C12.5746 15.2709 12.422 15.2077 12.2629 15.2077C12.1038 15.2077 11.9512 15.2709 11.8387 15.3834C11.7262 15.4959 11.663 15.6485 11.663 15.8076C11.663 15.9667 11.7262 16.1192 11.8387 16.2317C11.9512 16.3442 12.1038 16.4074 12.2629 16.4074C12.422 16.4074 12.5746 16.3442 12.6871 16.2317ZM5.61744 9.16212C5.72993 9.04962 5.79313 8.89704 5.79313 8.73795C5.79313 8.57885 5.72993 8.42627 5.61743 8.31377C5.50493 8.20127 5.35235 8.13807 5.19326 8.13807C5.03416 8.13807 4.88158 8.20127 4.76908 8.31377C4.65658 8.42627 4.59338 8.57885 4.59338 8.73794C4.59338 8.89704 4.65658 9.04962 4.76908 9.16212C4.88158 9.27462 5.03416 9.33782 5.19326 9.33782C5.35236 9.33782 5.50494 9.27462 5.61744 9.16212ZM11.8387 5.76872C11.9512 5.65622 12.1038 5.59302 12.2629 5.59302C12.422 5.59302 12.5745 5.65622 12.687 5.76872C12.7995 5.88122 12.8627 6.0338 12.8627 6.1929C12.8627 6.352 12.7995 6.50458 12.687 6.61708C12.5745 6.72957 12.422 6.79278 12.2629 6.79277C12.1038 6.79277 11.9512 6.72957 11.8387 6.61707C11.7262 6.50458 11.663 6.35199 11.663 6.1929C11.663 6.0338 11.7262 5.88122 11.8387 5.76872ZM5.61744 12.8383C5.50494 12.7258 5.35236 12.6626 5.19326 12.6626C5.03417 12.6626 4.88159 12.7258 4.76909 12.8383C4.65659 12.9508 4.59339 13.1034 4.59339 13.2625C4.59339 13.4216 4.65659 13.5742 4.76909 13.6867C4.88159 13.7992 5.03417 13.8624 5.19327 13.8624C5.35236 13.8624 5.50494 13.7992 5.61744 13.6867C5.72994 13.5742 5.79314 13.4216 5.79314 13.2625C5.79314 13.1034 5.72994 12.9508 5.61744 12.8383ZM14.3837 8.31378C14.4962 8.20129 14.6488 8.13809 14.8079 8.13809C14.967 8.13809 15.1196 8.20129 15.2321 8.31379C15.3446 8.42628 15.4078 8.57887 15.4078 8.73796C15.4078 8.89706 15.3446 9.04964 15.2321 9.16214C15.1196 9.27464 14.967 9.33784 14.8079 9.33784C14.6488 9.33784 14.4962 9.27464 14.3838 9.16214C14.2713 9.04964 14.2081 8.89706 14.208 8.73796C14.208 8.57886 14.2713 8.42628 14.3837 8.31378ZM8.1625 15.3834C8.05001 15.2709 7.89743 15.2077 7.73833 15.2077C7.57923 15.2077 7.42665 15.2709 7.31415 15.3834C7.20165 15.4959 7.13845 15.6485 7.13845 15.8076C7.13845 15.9667 7.20165 16.1192 7.31415 16.2317C7.42665 16.3442 7.57923 16.4074 7.73833 16.4074C7.89743 16.4074 8.05001 16.3442 8.16251 16.2317C8.275 16.1192 8.3382 15.9667 8.3382 15.8076C8.3382 15.6485 8.275 15.4959 8.1625 15.3834Z"
								fill="white"
							/>
						</g>
						<path
							d="M29.16 17H27V3.6H29.16V9.28H37.04V3.6H39.18V17H37.04V11.22H29.16V17ZM45.3392 17.2C42.5392 17.2 41.1792 15.34 41.1792 13.04V7.06H43.3192V12.46C43.3192 14.32 44.1792 15.26 46.2792 15.26C48.4792 15.26 49.4992 14.14 49.4992 11.98V7.06H51.6392V17H49.6592V13.92H49.5392C49.2192 15.6 47.8992 17.2 45.3392 17.2ZM55.5816 17H53.6016V3.6H55.7616V9.76H55.8816C56.2816 8.08 57.6016 6.86 59.9816 6.86C63.0416 6.86 64.7216 8.94 64.7216 12.04C64.7216 15.1 63.0216 17.2 59.8616 17.2C57.6016 17.2 56.1416 16.12 55.7216 14.14H55.5816V17ZM55.7616 12.14C55.7616 14.22 57.0416 15.22 59.1816 15.22C61.3616 15.22 62.5616 14.42 62.5616 12.04C62.5616 9.64 61.3416 8.82 59.2216 8.82C56.9816 8.82 55.7616 9.86 55.7616 11.98V12.14ZM68.1988 17H66.2188V3.6H68.3788V9.76H68.4988C68.8988 8.08 70.2188 6.86 72.5988 6.86C75.6588 6.86 77.3388 8.94 77.3388 12.04C77.3388 15.1 75.6388 17.2 72.4788 17.2C70.2188 17.2 68.7588 16.12 68.3388 14.14H68.1988V17ZM68.3788 12.14C68.3788 14.22 69.6588 15.22 71.7988 15.22C73.9788 15.22 75.1788 14.42 75.1788 12.04C75.1788 9.64 73.9588 8.82 71.8388 8.82C69.5988 8.82 68.3788 9.86 68.3788 11.98V12.14ZM80.9959 17H78.8359V3.6H80.9959V17ZM87.9961 17.2C84.7361 17.2 82.5961 15.36 82.5961 12.04C82.5961 8.94 84.7161 6.86 87.9561 6.86C91.0361 6.86 93.1361 8.56 93.1361 11.58C93.1361 11.94 93.1161 12.22 93.0561 12.52H84.6161C84.6961 14.44 85.6361 15.46 87.9361 15.46C90.0161 15.46 90.8761 14.78 90.8761 13.6V13.44H93.0361V13.62C93.0361 15.74 90.9561 17.2 87.9961 17.2ZM87.9161 8.56C85.7161 8.56 84.7561 9.54 84.6361 11.32H91.0961V11.28C91.0961 9.44 90.0361 8.56 87.9161 8.56Z"
							fill="white"
							fill-opacity="0.9"
						/>
						<path
							d="M97.36 19.24H96.64V17.92H97.3C97.64 17.92 97.8 17.84 97.8 17.42V17H96.6V13.9H99.32V17.4C99.32 18.64 98.6 19.24 97.36 19.24ZM110.864 17H108.584C106.444 17 105.124 16.06 105.124 13.64V8.86H103.444V7.06H105.124V4.88H107.264V7.06H110.864V8.86H107.264V13.52C107.264 14.74 107.824 15.06 109.064 15.06H110.864V17ZM114.375 17H112.215V3.6H114.375V10.1H114.495C114.835 8.42 116.055 6.86 118.595 6.86C121.335 6.86 122.675 8.66 122.675 11.08V17H120.535V11.6C120.535 9.6 119.635 8.8 117.575 8.8C115.215 8.8 114.375 10.08 114.375 12.18V17ZM129.617 17.2C126.357 17.2 124.217 15.36 124.217 12.04C124.217 8.94 126.337 6.86 129.577 6.86C132.657 6.86 134.757 8.56 134.757 11.58C134.757 11.94 134.737 12.22 134.677 12.52H126.237C126.317 14.44 127.257 15.46 129.557 15.46C131.637 15.46 132.497 14.78 132.497 13.6V13.44H134.657V13.62C134.657 15.74 132.577 17.2 129.617 17.2ZM129.537 8.56C127.337 8.56 126.377 9.54 126.257 11.32H132.717V11.28C132.717 9.44 131.657 8.56 129.537 8.56ZM144.793 17.2C141.533 17.2 139.393 15.36 139.393 12.04C139.393 8.94 141.513 6.86 144.753 6.86C147.833 6.86 149.933 8.56 149.933 11.58C149.933 11.94 149.913 12.22 149.853 12.52H141.413C141.493 14.44 142.433 15.46 144.733 15.46C146.813 15.46 147.673 14.78 147.673 13.6V13.44H149.833V13.62C149.833 15.74 147.753 17.2 144.793 17.2ZM144.713 8.56C142.513 8.56 141.553 9.54 141.433 11.32H147.893V11.28C147.893 9.44 146.833 8.56 144.713 8.56ZM153.151 20.4H151.731V18.44H153.671C154.551 18.44 154.911 18.2 155.211 17.52L155.451 17L150.551 7.06H152.971L155.511 12.34L156.491 14.72H156.651L157.591 12.32L159.931 7.06H162.311L157.131 18.08C156.311 19.86 155.191 20.4 153.151 20.4ZM168.367 17.2C165.107 17.2 162.967 15.36 162.967 12.04C162.967 8.94 165.087 6.86 168.327 6.86C171.407 6.86 173.507 8.56 173.507 11.58C173.507 11.94 173.487 12.22 173.427 12.52H164.987C165.067 14.44 166.007 15.46 168.307 15.46C170.387 15.46 171.247 14.78 171.247 13.6V13.44H173.407V13.62C173.407 15.74 171.327 17.2 168.367 17.2ZM168.287 8.56C166.087 8.56 165.127 9.54 165.007 11.32H171.467V11.28C171.467 9.44 170.407 8.56 168.287 8.56ZM183.303 17H180.623L177.643 7.06H179.883L181.543 12.7L182.003 15.26H182.163L182.903 12.5L184.983 7.06H187.743L189.843 12.5L190.583 15.26H190.743L191.203 12.7L192.863 7.06H195.063L192.043 17H189.363L187.183 11.28L186.423 8.84H186.263L185.503 11.28L183.303 17ZM199.08 17.2C197.02 17.2 195.72 16.24 195.72 14.6C195.72 13.06 196.96 12.26 198.92 12.04L203.44 11.56V10.98C203.44 9.34 202.72 8.76 200.82 8.76C198.98 8.76 198.08 9.36 198.08 10.82V10.9H195.94V10.82C195.94 8.56 197.82 6.86 200.98 6.86C204.14 6.86 205.56 8.58 205.56 10.96V17H203.58V14.52H203.44C202.92 16.2 201.34 17.2 199.08 17.2ZM197.88 14.46C197.88 15.26 198.42 15.64 199.66 15.64C201.92 15.64 203.44 14.8 203.44 12.84L199.54 13.28C198.42 13.42 197.88 13.68 197.88 14.46ZM214.008 17H211.728C209.588 17 208.268 16.06 208.268 13.64V8.86H206.588V7.06H208.268V4.88H210.408V7.06H214.008V8.86H210.408V13.52C210.408 14.74 210.968 15.06 212.208 15.06H214.008V17ZM220.379 17.2C217.099 17.2 214.959 15.1 214.959 12.04C214.959 8.94 217.099 6.86 220.379 6.86C223.359 6.86 225.539 8.54 225.539 11.02V11.22H223.399V11.1C223.399 9.56 222.279 8.8 220.339 8.8C218.099 8.8 217.099 9.86 217.099 12.04C217.099 14.18 218.099 15.26 220.339 15.26C222.279 15.26 223.399 14.5 223.399 12.96V12.82H225.539V13.04C225.539 15.52 223.359 17.2 220.379 17.2ZM229.297 17H227.137V3.6H229.297V10.1H229.417C229.757 8.42 230.977 6.86 233.517 6.86C236.257 6.86 237.597 8.66 237.597 11.08V17H235.457V11.6C235.457 9.6 234.557 8.8 232.497 8.8C230.137 8.8 229.297 10.08 229.297 12.18V17ZM241.699 5.9H239.539V3.6H241.699V5.9ZM241.699 17H239.539V7.06H241.699V17ZM245.859 17H243.699V7.06H245.679V10.14H245.819C246.119 8.46 247.439 6.86 249.959 6.86C252.719 6.86 254.079 8.72 254.079 11.02V17H251.919V11.6C251.919 9.74 251.079 8.8 249.019 8.8C246.839 8.8 245.859 9.92 245.859 12.08V17ZM260.324 16.1C257.364 16.1 255.604 14.24 255.604 11.48C255.604 8.72 257.444 6.86 260.464 6.86C262.544 6.86 264.104 7.8 264.464 9.54H264.584V7.06H266.564V15.84C266.564 19.18 264.484 20.6 261.224 20.6C258.284 20.6 256.244 19.22 256.244 16.82H258.384C258.384 18.26 259.224 18.8 261.344 18.8C263.604 18.8 264.424 18.18 264.424 15.96V13.52H264.284C263.924 15.02 262.584 16.1 260.324 16.1ZM257.784 11.48C257.784 13.52 258.984 14.24 261.024 14.24C263.224 14.24 264.424 13.32 264.424 11.56V11.28C264.424 9.6 263.184 8.74 261.084 8.74C259.004 8.74 257.784 9.44 257.784 11.48ZM278.5 17.2C274.34 17.2 271.58 14.48 271.58 10.3C271.58 6.12 274.34 3.4 278.5 3.4C282.28 3.4 284.92 5.4 284.92 8.6V8.88H282.54V8.6C282.54 6.56 281.24 5.46 278.52 5.46C275.38 5.46 273.86 6.96 273.86 10.3C273.86 13.64 275.38 15.12 278.52 15.12C281.24 15.12 282.54 14.04 282.54 11.98V11.72H284.92V11.98C284.92 15.2 282.3 17.2 278.5 17.2ZM291.512 17.2C288.252 17.2 286.112 15.36 286.112 12.04C286.112 8.94 288.232 6.86 291.472 6.86C294.552 6.86 296.652 8.56 296.652 11.58C296.652 11.94 296.632 12.22 296.572 12.52H288.132C288.212 14.44 289.152 15.46 291.452 15.46C293.532 15.46 294.392 14.78 294.392 13.6V13.44H296.552V13.62C296.552 15.74 294.472 17.2 291.512 17.2ZM291.432 8.56C289.232 8.56 288.272 9.54 288.152 11.32H294.612V11.28C294.612 9.44 293.552 8.56 291.432 8.56ZM300.43 17H298.27V3.6H300.43V17ZM307.43 17.2C304.17 17.2 302.03 15.36 302.03 12.04C302.03 8.94 304.15 6.86 307.39 6.86C310.47 6.86 312.57 8.56 312.57 11.58C312.57 11.94 312.55 12.22 312.49 12.52H304.05C304.13 14.44 305.07 15.46 307.37 15.46C309.45 15.46 310.31 14.78 310.31 13.6V13.44H312.47V13.62C312.47 15.74 310.39 17.2 307.43 17.2ZM307.35 8.56C305.15 8.56 304.19 9.54 304.07 11.32H310.53V11.28C310.53 9.44 309.47 8.56 307.35 8.56ZM318.888 17.2C315.688 17.2 313.868 15.94 313.868 13.64V13.58H316.028V13.74C316.028 15.04 316.808 15.46 318.888 15.46C320.828 15.46 321.408 15.06 321.408 14.18C321.408 13.36 320.928 13.1 319.508 12.9L316.788 12.54C314.908 12.3 313.768 11.5 313.768 9.84C313.768 8.1 315.348 6.86 318.408 6.86C321.448 6.86 323.287 8.08 323.287 10.44V10.5H321.148V10.38C321.148 9.2 320.548 8.58 318.348 8.58C316.528 8.58 315.888 8.98 315.888 9.92C315.888 10.7 316.288 10.98 317.788 11.18L320.088 11.5C322.448 11.8 323.528 12.6 323.528 14.24C323.528 16.1 321.688 17.2 318.888 17.2ZM331.606 17H329.326C327.186 17 325.866 16.06 325.866 13.64V8.86H324.186V7.06H325.866V4.88H328.006V7.06H331.606V8.86H328.006V13.52C328.006 14.74 328.566 15.06 329.806 15.06H331.606V17ZM335.117 5.9H332.957V3.6H335.117V5.9ZM335.117 17H332.957V7.06H335.117V17ZM340.037 17.2C337.977 17.2 336.677 16.24 336.677 14.6C336.677 13.06 337.917 12.26 339.877 12.04L344.397 11.56V10.98C344.397 9.34 343.677 8.76 341.777 8.76C339.937 8.76 339.037 9.36 339.037 10.82V10.9H336.897V10.82C336.897 8.56 338.777 6.86 341.937 6.86C345.097 6.86 346.517 8.58 346.517 10.96V17H344.537V14.52H344.397C343.877 16.2 342.297 17.2 340.037 17.2ZM338.837 14.46C338.837 15.26 339.377 15.64 340.617 15.64C342.877 15.64 344.397 14.8 344.397 12.84L340.497 13.28C339.377 13.42 338.837 13.68 338.837 14.46Z"
							fill="white"
							fill-opacity="0.15"
						/>
						<defs>
							<clipPath id="clip0_6_23">
								<rect y="1" width="20" height="20" rx="8" fill="white" />
							</clipPath>
						</defs>
					</svg>

					<Flex align="center" gap="12">
						<Flex align="center" gap="8">
							<Text size="14" weight="500" color="tertiary"> Celenium API: </Text>

							<Flex align="center" gap="4">
								<Icon name="zap-circle" size="14" color="green" />
								<Text size="14" weight="600" color="green"> Stable </Text>
							</Flex>
						</Flex>

						<div :class="$style.dot" />

						<Flex align="center" gap="8">
							<Text size="14" weight="500" color="tertiary"> Socket: </Text>
							<Flex align="center" gap="4">
								<Icon name="check-circle" size="14" color="secondary" />
								<Text size="14" weight="600" color="secondary"> Connected </Text>
							</Flex>
						</Flex>
					</Flex>
				</Flex>

				<Dropdown fullWidth>
					<Flex align="center" gap="16" :class="$style.network_selector">
						<Flex align="center" gap="8">
							<svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
								<path
									fill-rule="evenodd"
									clip-rule="evenodd"
									d="M13.4177 7.19085C13.4163 7.23422 13.3573 7.24568 13.3402 7.2057C13.3329 7.18845 13.3254 7.17114 13.3178 7.15383C13.3039 7.12216 13.3078 7.08533 13.3286 7.05763C13.3329 7.05197 13.3416 7.04051 13.3521 7.02685C13.3801 6.99015 13.4206 6.99562 13.4206 7.03636C13.4206 7.0898 13.4194 7.13608 13.4177 7.19085ZM13.1069 6.34222C13.0591 6.4284 12.9364 6.43237 12.8833 6.34927C12.875 6.33643 12.8667 6.32359 12.8583 6.31068C12.6668 6.01662 12.4464 5.72797 12.2003 5.44745C12.1398 5.37858 12.1892 5.27048 12.2809 5.27042H12.2831C12.8583 5.27042 13.1599 5.41251 13.2519 5.58601C13.3287 5.73112 13.3052 5.98489 13.1069 6.34222ZM12.9784 9.35031C12.9475 9.42881 12.9152 9.50681 12.8813 9.58406C12.876 9.5947 12.871 9.60546 12.8656 9.61604C12.6538 10.0235 12.2986 10.3444 11.8239 10.5677C11.7173 10.6178 11.6008 10.5203 11.6325 10.407C11.7902 9.8428 11.9095 9.23095 11.9868 8.58951C12.0012 8.46989 12.0602 8.3601 12.1513 8.28128C12.3466 8.11237 12.5289 7.94372 12.6966 7.77626L12.6984 7.77437C12.7809 7.69203 12.9217 7.72747 12.9553 7.83915C13.121 8.38994 13.1302 8.90296 12.9784 9.35031ZM11.6879 11.3873C11.6396 11.4389 11.5904 11.4899 11.5401 11.5401C11.4526 11.6275 11.363 11.712 11.2715 11.7937C11.2138 11.8451 11.1264 11.7808 11.1591 11.7107C11.1684 11.6906 11.1777 11.6705 11.1869 11.6502C11.2253 11.5654 11.2625 11.4784 11.2986 11.3897C11.3072 11.3688 11.3252 11.3532 11.3471 11.3476C11.4381 11.3245 11.5269 11.299 11.6133 11.2711C11.6834 11.2486 11.7383 11.3335 11.6879 11.3873ZM10.7403 10.878C10.5486 10.9057 10.3471 10.9237 10.1363 10.9311C9.62189 10.9491 9.07797 10.9047 8.51925 10.8019C8.45113 10.7893 8.43804 10.6972 8.49979 10.666C8.62167 10.6043 8.74362 10.5412 8.8655 10.4766C9.72042 10.0235 10.5181 9.52816 11.2164 9.0203C11.2688 8.98221 11.3409 9.02716 11.3303 9.09106C11.2335 9.67308 11.0994 10.221 10.931 10.7183C10.9023 10.803 10.8289 10.8651 10.7403 10.878ZM10.5427 11.6534C10.0843 12.5549 9.51978 13.061 8.97258 13.0508C8.37785 13.0403 7.78482 12.4209 7.34565 11.3518L7.34515 11.3506C7.31726 11.2827 7.3493 11.205 7.41654 11.1758C7.4212 11.1737 7.42586 11.1717 7.43051 11.1696C7.45935 11.1571 7.49171 11.1548 7.52205 11.1634C8.34354 11.3939 9.15295 11.5142 9.9113 11.5142C9.9937 11.5142 10.0755 11.5129 10.1567 11.51C10.2517 11.5066 10.3452 11.5013 10.437 11.494C10.5222 11.4872 10.5814 11.5772 10.5427 11.6534ZM7.82832 13.3677C7.55579 13.4028 7.27923 13.4207 6.99997 13.4207C5.75196 13.4207 4.55828 13.067 3.53344 12.4071C3.46294 12.3616 3.4929 12.2522 3.57669 12.2484C3.59407 12.2475 3.61031 12.2467 3.6246 12.2458C3.88504 12.2288 4.17061 12.1907 4.48003 12.1311C5.13822 12.0045 5.86987 11.7873 6.63597 11.4948C6.70465 11.4686 6.78133 11.5027 6.80928 11.5707L6.80978 11.5718C7.10668 12.2947 7.47206 12.8409 7.88234 13.1883C7.95014 13.2458 7.91646 13.3564 7.82832 13.3677ZM4.11533 8.86902C4.6811 8.40832 5.34401 7.94863 6.0712 7.51342C6.08681 8.44351 6.1888 9.33646 6.36929 10.143C6.09959 10.028 5.83072 9.90135 5.56417 9.76291C5.04788 9.4946 4.56212 9.19406 4.11533 8.86902ZM2.35582 11.3611C2.22084 11.1065 2.39529 10.5166 3.2815 9.62007L3.28194 9.61963C3.37448 9.52614 3.36561 9.37272 3.2623 9.29132C3.22679 9.26343 3.19154 9.23523 3.15654 9.20702C3.06827 9.1357 2.94054 9.14225 2.8604 9.22251C2.84283 9.24008 2.82974 9.2533 2.8259 9.25726C2.38289 9.71198 2.07284 10.1329 1.89915 10.5115C1.84992 10.6188 1.70122 10.6304 1.63612 10.5319C0.948598 9.49259 0.579307 8.27473 0.579307 6.99997C0.579307 6.54424 0.626649 6.09575 0.718751 5.66011C0.732664 5.59419 0.825648 5.58998 0.845163 5.65444C0.978375 6.09424 1.19519 6.54915 1.49479 7.00916C1.89808 7.62851 2.42992 8.22387 3.06015 8.77C3.27527 8.9564 3.50247 9.1367 3.73943 9.31065C4.21977 9.66313 4.74173 9.98842 5.29705 10.2769C5.5432 10.4049 5.78293 10.5269 6.02845 10.6375C6.16513 10.699 6.32069 10.7038 6.4602 10.649C6.57597 10.6037 6.69256 10.5565 6.80985 10.5075C6.93739 10.4543 7.00658 10.3152 6.97277 10.1812C6.96855 10.1644 6.96522 10.151 6.96333 10.143C6.77 9.32941 6.66253 8.41348 6.64988 7.45412L6.6495 7.45431C6.64937 7.44292 6.64944 7.43133 6.64931 7.41981C6.64875 7.36737 6.64906 7.31455 6.64812 7.26224C6.6478 7.24555 6.6483 7.21729 6.64849 7.20054C6.64862 7.19387 6.64849 7.18726 6.64849 7.18065L6.64875 7.18058C6.64906 7.12053 6.6495 7.06053 6.65057 7.00028C6.65353 6.83572 6.65945 6.67235 6.66795 6.51031L6.66763 6.5105C6.72725 5.35283 6.92354 4.26504 7.23586 3.34999C7.26475 3.26532 7.21962 3.17341 7.13494 3.14451C7.05241 3.11631 6.96994 3.08936 6.88759 3.06355C6.80431 3.03743 6.71529 3.08238 6.68715 3.16503C6.34864 4.15877 6.13976 5.33772 6.08404 6.58529C6.07693 6.74355 5.99081 6.88759 5.85451 6.96837C5.11562 7.40628 4.43703 7.8705 3.8508 8.33844C3.72867 8.43596 3.55422 8.43225 3.43612 8.32982C2.84856 7.82039 2.35406 7.26708 1.98023 6.693C1.24562 5.56498 1.07104 4.50231 1.48881 3.70128C1.48994 3.69939 1.49095 3.69744 1.49202 3.69561C1.54528 3.60723 1.60068 3.52004 1.65835 3.43404C2.13837 2.79864 3.03182 2.43042 4.21675 2.38881C4.29173 2.38616 4.36721 2.38484 4.44339 2.38484C5.1702 2.38484 5.9502 2.50477 6.74349 2.73367L6.74368 2.73348C6.76106 2.73852 6.77843 2.74374 6.79581 2.74884C6.80922 2.75281 6.82263 2.75652 6.83603 2.76055C7.01936 2.81532 7.20319 2.87607 7.38726 2.9423C7.39154 2.94381 7.39589 2.94539 7.40017 2.9469C7.44814 2.96421 7.49605 2.98196 7.54396 3.00003C7.55894 3.0057 7.57399 3.01143 7.58897 3.01722C7.60339 3.02276 7.6178 3.02811 7.63228 3.03371L7.63209 3.03396C8.01952 3.18392 8.40662 3.3583 8.78888 3.55699C9.52879 3.94139 10.206 4.39202 10.7954 4.8864C9.67062 5.14407 8.36318 5.64116 7.04863 6.31137C6.98801 6.34235 6.94809 6.40329 6.94425 6.47128C6.93966 6.55274 6.93361 6.71655 6.92927 6.84674C6.92656 6.92845 7.013 6.98259 7.0854 6.94457L7.08615 6.94413C8.38767 6.26069 9.68661 5.74988 10.8021 5.47993C11.0106 5.42951 11.1456 5.22925 11.1163 5.01678C11.0958 4.86833 11.0727 4.72221 11.0471 4.57868C11.015 4.39838 10.9163 4.23715 10.7706 4.12622C10.2482 3.72823 9.67238 3.36315 9.056 3.04284C8.64062 2.82703 8.21914 2.63792 7.79678 2.47663C7.70644 2.44213 7.66773 2.33536 7.71488 2.25094C8.15002 1.4725 8.66757 1.03654 9.17177 1.03654C9.177 1.03654 9.18222 1.03654 9.18745 1.03667C9.78218 1.04731 10.3752 1.66659 10.8144 2.73575C11.0367 3.27697 11.2089 3.9011 11.3266 4.57937C11.326 4.5788 11.3254 4.5783 11.3248 4.57773C11.3751 4.8672 11.4155 5.16636 11.4456 5.47326C11.443 5.4749 11.4402 5.47634 11.4376 5.47798C11.4412 5.48157 11.4449 5.48516 11.4485 5.48881C11.4983 6.00378 11.5193 6.54002 11.5095 7.08722C11.5033 7.43335 11.4848 7.77469 11.455 8.10866C10.6593 8.75168 9.67553 9.39161 8.59416 9.96468C8.23879 10.153 7.88347 10.3284 7.53162 10.4898C7.52614 10.4923 7.52073 10.4948 7.51525 10.4973C7.48837 10.5096 7.46142 10.522 7.43454 10.5342L7.43391 10.534C7.14237 10.6659 6.8536 10.7879 6.56961 10.8993L6.56974 10.8996C6.55368 10.9059 6.53776 10.9119 6.52177 10.9181C6.50181 10.9259 6.48185 10.9336 6.46196 10.9413C6.4143 10.9596 6.36684 10.9776 6.31949 10.9952C6.30646 11.0001 6.29337 11.0052 6.28034 11.01C6.22286 11.0313 6.1657 11.052 6.10872 11.0724C6.10161 11.0749 6.09449 11.0777 6.08744 11.0802L6.08719 11.08C5.47861 11.2968 4.89886 11.4605 4.37055 11.5622C3.0939 11.808 2.49274 11.6194 2.35582 11.3611ZM3.27275 1.77059C4.3533 0.996821 5.6445 0.579307 6.99997 0.579307C7.35774 0.579307 7.71091 0.608581 8.05697 0.66568C8.14964 0.680978 8.18074 0.79927 8.10683 0.857251C7.77147 1.12015 7.45991 1.50914 7.18417 2.0136C7.11687 2.13667 6.97416 2.19686 6.83918 2.15883C5.92565 1.90167 5.02685 1.78067 4.19642 1.80981C3.89008 1.82058 3.59999 1.85162 3.32746 1.90185C3.2509 1.91596 3.20948 1.81586 3.27275 1.77059ZM12.0862 6.45C12.0844 6.3764 12.1788 6.34499 12.2215 6.40492C12.2739 6.47852 12.3245 6.55249 12.3729 6.62684C12.4372 6.72568 12.4971 6.82395 12.5527 6.92159C12.5874 6.98247 12.5791 7.05883 12.5319 7.11058C12.4569 7.19292 12.3756 7.27804 12.2873 7.3663C12.255 7.39847 12.2222 7.4307 12.1887 7.463C12.1471 7.50316 12.0774 7.47257 12.0797 7.41477C12.0838 7.30945 12.0868 7.20375 12.0887 7.09755C12.0926 6.87998 12.0917 6.66398 12.0862 6.45ZM11.4204 2.34323C11.4607 2.3815 11.5006 2.42041 11.5401 2.45988C12.1588 3.0786 12.6354 3.80157 12.9541 4.58894C12.9862 4.66832 12.9188 4.75142 12.8345 4.73625C12.6501 4.70314 12.4426 4.68834 12.2129 4.69218C12.0537 4.69483 11.9153 4.58327 11.8874 4.42652C11.7625 3.72653 11.582 3.07992 11.3502 2.5156C11.337 2.48343 11.3237 2.45164 11.3101 2.42016C11.2807 2.35147 11.3662 2.29173 11.4204 2.34323ZM13.8488 5.54408C13.5722 4.22978 12.9217 3.02219 11.9497 2.05017C10.6276 0.728068 8.86978 0 6.99997 0C5.13022 0 3.37234 0.728068 2.05024 2.05017C1.72867 2.37175 1.44266 2.71919 1.1933 3.0876C1.11914 3.18631 1.05272 3.29057 0.993673 3.39967C0.345935 4.476 0 5.71142 0 6.99997C0 8.86978 0.728131 10.6276 2.05024 11.9497C3.37234 13.2718 5.13022 14 6.99997 14C8.86978 14 10.6276 13.2718 11.9497 11.9497C12.5737 11.3258 13.0652 10.6047 13.4104 9.82064C13.4526 9.73376 13.4894 9.64481 13.5211 9.55409C13.8354 8.75105 14 7.88819 14 6.99997C14 6.51106 13.9498 6.03003 13.8526 5.56221C13.8513 5.55617 13.8501 5.55013 13.8488 5.54408Z"
									:fill="appStore.network === 'mainnet' ? '#4CDC89' : 'var(--orange)'"
								/>
							</svg>
							<Text size="14" weight="600" color="primary" style="text-transform: capitalize">
								Celestia {{ appStore.network }}
							</Text>
						</Flex>

						<Icon name="chevron" size="16" color="tertiary" />
					</Flex>

					<template #popup>
						<DropdownItem @click="appStore.network = 'mainnet'">
							<Flex align="center" gap="8">
								<Icon :name="appStore.network === 'mainnet' ? 'check' : ''" size="14" color="secondary" /> Mainnet
							</Flex>
						</DropdownItem>
						<DropdownItem @click="appStore.network = 'mocha'">
							<Flex align="center" gap="8">
								<Icon :name="appStore.network === 'mocha' ? 'check' : ''" size="14" color="secondary" /> Mocha
							</Flex>
						</DropdownItem>
					</template>
				</Dropdown>
			</Flex>

			<Feed :txs="txs" />

			<TPM />
		</Flex>

		<Flex direction="column" justify="between"> </Flex>
	</Flex>
</template>

<style module>
.wrapper {
	position: relative;
	width: 100%;
	height: 100%;

	overflow: hidden;
	background: var(--card-background);

	padding: 20px;
}

.atm_wrapper {
	position: absolute;
	left: 0;
	right: 0;
	top: 0;
	bottom: 0;

	pointer-events: none;

	display: flex;
	align-items: center;
	justify-content: center;
}

.atm {
	aspect-ratio: auto 1/1;
	height: 90%;

	transform-origin: center;
	transform: rotate(-52deg);

	border-radius: 50%;

	box-shadow: #1f87dd52 -0.8em 0 5.8em -1.5em inset;

	animation: fhl 20s ease infinite;
	animation-delay: 10s;
}
.atm {
	box-shadow: #2374ffe0 -2em 0 3em -0.5em inset, #000e1ad9 -3em 0 4em -1em inset, #007aec30 -60em 0 20em -40em inset;
	mix-blend-mode: color-dodge;
	color: #4c86e99e;
	filter: blur(0.2em) drop-shadow(0.3em 0 4.5em);
	touch-action: none;
}

.atm::before,
.atm::after {
	content: "";
	display: block;
	height: 100%;
	border-radius: 50%;
	box-shadow: #2d8de7 -1.5em 0 1em -1em inset;
	mix-blend-mode: color-dodge;
}
.atm::after {
	margin-top: -100%;
}

@keyframes fhl {
	0% {
		opacity: 1;
		transform: rotate(-52deg) scale(1);
	}

	15% {
		opacity: 0;
	}

	30% {
		opacity: 0;
		transform: rotate(-52deg) scale(2);
	}

	32% {
		opacity: 0;
	}

	40% {
		opacity: 1;
		transform: rotate(-52deg) scale(1);
	}

	100% {
		opacity: 1;
		transform: rotate(-52deg) scale(1);
	}
}

.controls {
	z-index: 1;
}

.dot {
	width: 6px;
	height: 6px;

	border-radius: 50%;
	background: var(--op-10);
}

.network_selector {
	width: fit-content;
	height: 38px;

	border-radius: 10px;
	border: 2px solid var(--op-5);
	cursor: pointer;

	padding: 0 14px;

	transition: all 0.2s ease;

	&:hover {
		border: 2px solid var(--op-10);
	}

	&:active {
		border: 2px solid var(--op-15);
		background: var(--op-5);
	}
}
</style>
../local/TPM.vue
